<!-- pages/record/handwrite/handwrite.wxml -->
<view class="container">
  <!-- 画布区域 -->
  <view class="canvas-section">
    <canvas
      canvas-id="handwriteCanvas"
      id="handwriteCanvas"
      class="handwrite-canvas"
      disable-scroll="true"
      bindtouchstart="touchStart"
      bindtouchmove="touchMove"
      bindtouchend="touchEnd"
    />

    <view class="canvas-placeholder" wx:if="{{!hasDrawing}}">
      <text class="placeholder-text">🎨 在此区域自由绘画</text>
    </view>
  </view>

  <!-- 工具栏 -->
  <view class="toolbar">
    <!-- 颜色选择 -->
    <view class="tool-group">
      <text class="tool-label">颜色</text>
      <view class="color-picker">
        <view
          class="color-item {{lineColor === item ? 'active' : ''}}"
          wx:for="{{colors}}"
          wx:key="index"
          style="background-color: {{item}}"
          bindtap="selectColor"
          data-color="{{item}}"
        />
      </view>
    </view>

    <!-- 粗细选择 -->
    <view class="tool-group">
      <text class="tool-label">粗细</text>
      <view class="width-picker">
        <view
          class="width-item {{lineWidth === item ? 'active' : ''}}"
          wx:for="{{lineWidths}}"
          wx:key="index"
          bindtap="selectLineWidth"
          data-width="{{item}}"
        >
          <view class="width-dot" style="width: {{item * 2}}rpx; height: {{item * 2}}rpx" />
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="tool-actions">
      <button class="btn-ghost btn-small" bindtap="clearCanvas">
        清空
      </button>
      <button class="btn-secondary btn-small" bindtap="undoDrawing" disabled="{{!hasDrawing}}">
        撤销
      </button>
    </view>
  </view>

  <!-- 灵感描述 -->
  <view class="inspiration-section" wx:if="{{hasDrawing}}">
    <view class="inspiration-header">
      <text class="inspiration-title">灵感描述</text>
      <text class="inspiration-length">{{inspirationText.length}}字</text>
    </view>

    <view class="inspiration-content">
      <textarea
        class="inspiration-textarea"
        value="{{inspirationText}}"
        placeholder="描述一下你的创作灵感..."
        maxlength="-1"
        auto-height
        bindinput="onInspirationInput"
        placeholder-class="textarea-placeholder"
      />
    </view>

    <view class="inspiration-actions">
      <button class="btn-primary" bindtap="saveInspiration">
        保存灵感
      </button>
    </view>
  </view>

  <!-- 使用提示 -->
  <view class="tips-section" wx:if="{{!hasDrawing}}">
    <view class="tips-title">💡 使用提示</view>
    <view class="tips-list">
      <view class="tip-item">• 支持多种颜色和笔触粗细</view>
      <view class="tip-item">• 可随时清空或撤销上一笔</view>
      <view class="tip-item">• 绘画完成后添加灵感描述</view>
      <view class="tip-item">• 作品将保存为灵感笔记</view>
    </view>
  </view>
</view>
