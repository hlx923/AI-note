<!-- pages/record/photo/photo.wxml -->
<view class="container">
  <!-- 拍照区域 -->
  <view class="photo-section" wx:if="{{photos.length === 0}}">
    <view class="photo-placeholder">
      <view class="placeholder-icon">📷</view>
      <text class="placeholder-text">拍照或选择图片</text>
      <text class="placeholder-hint">支持最多{{maxPhotos}}张照片</text>
    </view>

    <view class="photo-actions">
      <button class="btn-primary" bindtap="takePhoto">
        拍照
      </button>
      <button class="btn-secondary" bindtap="chooseFromAlbum">
        从相册选择
      </button>
    </view>
  </view>

  <!-- 照片预览和备注 -->
  <view class="photos-preview" wx:if="{{photos.length > 0}}">
    <view class="preview-header">
      <text class="preview-title">已选择 {{photos.length}}/{{maxPhotos}} 张</text>
      <text class="preview-reset" bindtap="resetPhotos">重新选择</text>
    </view>

    <view class="preview-grid">
      <view class="preview-item" wx:for="{{photos}}" wx:key="index">
        <image
          class="preview-image"
          src="{{item}}"
          mode="aspectFill"
          bindtap="previewImage"
          data-index="{{index}}"
        />
        <view class="preview-delete" bindtap="deletePhoto" data-index="{{index}}">
          ×
        </view>
      </view>

      <!-- 添加更多 -->
      <view class="preview-add" wx:if="{{photos.length < maxPhotos}}" bindtap="takePhoto">
        <text class="add-icon">+</text>
        <text class="add-text">继续添加</text>
      </view>
    </view>

    <!-- 备注输入区 -->
    <view class="note-input-section">
      <view class="input-header">
        <text class="input-title">照片备注</text>
        <text class="input-length">{{noteContent.length}}字</text>
      </view>
      <textarea
        class="note-textarea"
        value="{{noteContent}}"
        bindinput="onNoteInput"
        placeholder="请输入对照片的备注说明..."
        maxlength="-1"
        auto-height
        placeholder-class="textarea-placeholder"
      />
    </view>

    <view class="save-actions">
      <button class="btn-primary" bindtap="saveNote">
        保存笔记
      </button>
    </view>
  </view>

  <!-- 使用提示 -->
  <view class="tips-section" wx:if="{{photos.length === 0}}">
    <view class="tips-title">💡 使用提示</view>
    <view class="tips-list">
      <view class="tip-item">• 支持最多3张照片</view>
      <view class="tip-item">• 添加照片后输入备注说明</view>
      <view class="tip-item">• 照片和备注将一起保存为笔记</view>
      <view class="tip-item">• 适合记录图片资料、截图等</view>
    </view>
  </view>
</view>
