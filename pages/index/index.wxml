<!-- pages/index/index.wxml -->
<view class="container" style="height: 1231rpx; display: block; box-sizing: border-box">
  <!-- 顶部欢迎区 -->
  <view class="welcome-section">
    <text class="welcome-subtitle">轻量录入 · 智能规整 · 即时检索</text>
  </view>

  <!-- 快速录入入口 -->
  <view class="quick-actions">
    <view class="action-card" bindtap="goToPhotoRecord">
      <view class="action-icon">📷</view>
      <text class="action-title">拍照记笔记</text>
      <text class="action-desc">记录图片笔记</text>
    </view>

    <view class="action-card" bindtap="goToHandwrite">
      <view class="action-icon">✍️</view>
      <text class="action-title">手写涂鸦</text>
      <text class="action-desc">手写自动规整</text>
    </view>
  </view>

  <!-- 高级功能入口 -->
  <view class="advanced-actions">
    <view class="advanced-card" bindtap="goToSummary">
      <view class="advanced-icon">📄</view>
      <view class="advanced-info">
        <text class="advanced-title">长文总结</text>
        <text class="advanced-desc">AI智能提取核心观点</text>
      </view>
      <text class="advanced-arrow">›</text>
    </view>

    <view class="advanced-card" bindtap="goToTemplate">
      <view class="advanced-icon">📋</view>
      <view class="advanced-info">
        <text class="advanced-title">模板笔记</text>
        <text class="advanced-desc">场景化模板快速记录</text>
      </view>
      <text class="advanced-arrow">›</text>
    </view>
  </view>

  <!-- 最近查看/编辑 -->
  <view class="recent-section" wx:if="{{recentNotes.length > 0}}">
    <view class="section-header">
      <text class="section-title">最近查看</text>
      <text class="section-more" bindtap="goToNoteList">查看全部 ></text>
    </view>

    <view class="note-list">
      <view class="note-item" wx:for="{{recentNotes}}" wx:key="id" bindtap="goToNoteDetail" data-id="{{item.id}}">
        <view class="note-header">
          <text class="note-title">{{item.title}}</text>
          <view class="note-tag">{{item.tag}}</view>
        </view>
        <text class="note-content">{{item.content}}</text>
        <text class="note-time">{{item.timeAgo}}</text>
      </view>
    </view>
  </view>

  <!-- 统计信息 -->
  <view class="stats-section" wx:if="{{recentNotes.length === 0}}">
    <view class="stat-item">
      <text class="stat-number">{{totalNotes}}</text>
      <text class="stat-label">笔记总数</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{todayNotes}}</text>
      <text class="stat-label">今日新增</text>
    </view>
    <view class="stat-item">
      <text class="stat-number">{{totalTags}}</text>
      <text class="stat-label">标签数量</text>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{recentNotes.length === 0}}">
    <text class="empty-icon">📝</text>
    <text class="empty-text">还没有笔记，快来创建第一条吧！</text>
  </view>

  <!-- 灵感闪记浮动按钮 -->
  <view class="quick-record-fab" bindtap="showQuickRecordModal">
    <text class="fab-icon">💡</text>
  </view>

  <!-- 快速待办弹窗 -->
  <view class="quick-record-modal" wx:if="{{showQuickRecord}}" bindtap="hideQuickRecordModal">
    <view class="quick-record-content" catchtap="doNothing">
      <view class="quick-record-header">
        <text class="quick-record-title">快速待办</text>
        <text class="quick-record-close" bindtap="hideQuickRecordModal">×</text>
      </view>

      <view class="quick-record-body">
        <view class="input-label">待办事件</view>
        <textarea
          class="quick-todo-input"
          value="{{quickTodoContent}}"
          placeholder="请输入待办事项..."
          maxlength="-1"
          auto-height
          bindinput="onQuickTodoInput"
          cursor-spacing="100"
          adjust-position="{{true}}"
          show-confirm-bar="{{false}}"
        />

        <view class="quick-todo-info">
          <view class="info-row">
            <text class="info-label">记录时间</text>
            <text class="info-value">{{quickRecordTime}}</text>
          </view>
          <view class="info-row-type">
            <text class="info-label">记录类型</text>
            <view class="tag-selector">
              <view
                class="tag-option {{quickTodoTag === item ? 'active' : ''}}"
                wx:for="{{['待办', '学习', '工作', '生活', '灵感']}}"
                wx:key="index"
                bindtap="selectQuickTodoTag"
                data-tag="{{item}}"
              >
                {{item}}
              </view>
            </view>
          </view>
        </view>
      </view>

      <view class="quick-record-footer">
        <button class="btn-quick-record" bindtap="saveQuickTodo">
          保存待办
        </button>
      </view>
    </view>
  </view>
</view>
