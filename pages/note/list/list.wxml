<!-- pages/note/list/list.wxml -->
<view class="container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <scroll-view class="tag-scroll" scroll-x>
      <view class="tag-list">
        <view
          class="tag-item {{selectedTag === '' ? 'active' : ''}}"
          bindtap="selectTag"
          data-tag=""
        >
          å…¨éƒ¨
        </view>
        <view
          class="tag-item {{selectedTag === item ? 'active' : ''}}"
          wx:for="{{tags}}"
          wx:key="index"
          bindtap="selectTag"
          data-tag="{{item}}"
        >
          {{item}}
        </view>
      </view>
    </scroll-view>

    <!-- æº¢å‡ºç®­å¤´ï¼šå½“æ ‡ç­¾æº¢å‡ºæ—¶æ˜¾ç¤ºï¼Œç‚¹å‡»å±•å¼€ä¸‹æ‹‰èœå•æŸ¥çœ‹è¢«éšè—çš„æ ‡ç­¾ -->
    <view class="more-arrow" wx:if="{{showMoreArrow}}" bindtap="toggleOverflowMenu">
      <text>â–¾</text>
    </view>

    <view class="filter-icon" bindtap="showFilterMenu">
      <text>ç­›é€‰</text>
    </view>
  </view>

  <!-- æº¢å‡ºæ ‡ç­¾ä¸‹æ‹‰èœå• -->
  <view class="overflow-mask" wx:if="{{showOverflowMenu}}" bindtap="closeOverflowMenu">
    <view class="overflow-menu" catchtap="stopPropagation">
      <view class="overflow-item" wx:for="{{overflowTags}}" wx:key="index" bindtap="selectOverflowTag" data-tag="{{item}}">
        {{item}}
      </view>
    </view>
  </view>

  <!-- ç¬”è®°åˆ—è¡¨ -->
  <view class="note-list" wx:if="{{notes.length > 0}}">
    <view
      class="note-item"
      wx:for="{{notes}}"
      wx:key="id"
      bindtap="goToDetail"
      data-id="{{item.id}}"
    >
      <view class="note-header">
        <text class="note-title">{{item.title}}</text>
        <view class="note-lock" wx:if="{{item.isLocked}}">ğŸ”’</view>
      </view>

      <text class="note-content">{{item.content}}</text>

      <view class="note-footer">
        <view class="note-tag">{{item.tag}}</view>
        <text class="note-time">{{item.timeAgo}}</text>
      </view>

      <!-- å…³é”®è¯ -->
      <view class="note-keywords" wx:if="{{item.keywords && item.keywords.length > 0}}">
        <view class="keyword-tag" wx:for="{{item.keywords}}" wx:key="index" wx:for-item="keyword">
          #{{keyword}}
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{notes.length === 0}}">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">{{selectedTag ? 'è¯¥æ ‡ç­¾ä¸‹æš‚æ— ç¬”è®°' : 'è¿˜æ²¡æœ‰ç¬”è®°ï¼Œå¿«å»åˆ›å»ºå§'}}</text>
  </view>

  <!-- å¿«é€Ÿåˆ›å»ºæŒ‰é’® -->
  <view class="fab" bindtap="showCreateMenu">
    <text class="fab-icon">+</text>
  </view>
</view>

<!-- ç­›é€‰èœå• -->
<view class="modal-mask" wx:if="{{showFilter}}" bindtap="hideFilterMenu">
  <view class="filter-menu" catchtap="stopPropagation">
    <view class="menu-title">ç­›é€‰æ¡ä»¶</view>

    <view class="filter-section">
      <text class="filter-label">æ—¶é—´èŒƒå›´</text>
      <view class="filter-options">
        <view
          class="filter-option {{timeRange === '' ? 'active' : ''}}"
          bindtap="selectTimeRange"
          data-range=""
        >
          å…¨éƒ¨
        </view>
        <view
          class="filter-option {{timeRange === '7days' ? 'active' : ''}}"
          bindtap="selectTimeRange"
          data-range="7days"
        >
          æœ€è¿‘7å¤©
        </view>
        <view
          class="filter-option {{timeRange === '30days' ? 'active' : ''}}"
          bindtap="selectTimeRange"
          data-range="30days"
        >
          æœ€è¿‘30å¤©
        </view>
      </view>
    </view>

    <view class="filter-actions">
      <button class="btn-ghost" bindtap="resetFilter">é‡ç½®</button>
      <button class="btn-primary" bindtap="applyFilter">ç¡®å®š</button>
    </view>
  </view>
</view>

<!-- åˆ›å»ºèœå• -->
<view class="modal-mask" wx:if="{{showCreate}}" bindtap="hideCreateMenu">
  <view class="create-menu" catchtap="stopPropagation">
    <view class="create-item" bindtap="goToPhotoRecord">
      <view class="create-icon">ğŸ“·</view>
      <text class="create-text">æ‹ç…§è®°ç¬”è®°</text>
    </view>
    <view class="create-item" bindtap="goToHandwrite">
      <view class="create-icon">âœï¸</view>
      <text class="create-text">æ‰‹å†™æ¶‚é¸¦</text>
    </view>
  </view>
</view>
